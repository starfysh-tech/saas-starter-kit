graph TD
    subgraph "Analyst/Researcher Access Pattern"
        A1["Research Query Development<br/>• Hypothesis<br/>• Metrics<br/>• Cohorts"] --> A2["SQL Database Direct Access<br/>• JOIN queries<br/>• Aggregations<br/>• Time series"] --> A3["Results Analysis<br/>• Statistical<br/>• Visualization<br/>• Reporting"]
    end

    subgraph "EXAMPLE ANALYSIS QUERIES"
        Q1["1 Treatment Response Analysis:<br/>   WITH treatment_data AS (<br/>     SELECT p.id, p.created_at,<br/>       MAX(CASE WHEN pv.field_name = 'lymphoma_subtype'<br/>           THEN pv.field_value END) as subtype,<br/>       MAX(CASE WHEN pv.field_name = 'treatment_status'<br/>           THEN pv.field_value END) as treatment<br/>     FROM Patient p<br/>     JOIN PatientFieldValue pv ON p.id = pv.patient_id<br/>     GROUP BY p.id, p.created_at<br/>   )<br/>   SELECT subtype, treatment, COUNT(*) as patient_count<br/>   FROM treatment_data<br/>   GROUP BY subtype, treatment;"] --> Q2["2 Symptom Severity Trends:<br/>   SELECT<br/>     REPLACE(pv.field_name, '_severity', '') as symptom,<br/>     pv.field_value::integer as severity,<br/>     COUNT(*) as frequency,<br/>     AVG(pv.field_value::integer) as avg_severity<br/>   FROM PatientFieldValue pv<br/>   WHERE pv.field_name LIKE '%_severity'<br/>   GROUP BY symptom, severity<br/>   ORDER BY symptom, severity;"] --> Q3["3 Template Usage Analytics:<br/>   SELECT<br/>     ft.name as template_name,<br/>     t.name as team_name,<br/>     fa.version,<br/>     COUNT(p.id) as patients_created,<br/>     MIN(p.created_at) as first_patient,<br/>     MAX(p.created_at) as latest_patient<br/>   FROM FormTemplate ft<br/>   JOIN FormAssignment fa ON ft.id = fa.template_id<br/>   JOIN Team t ON fa.team_id = t.id<br/>   JOIN Patient p ON fa.id = p.form_assignment_id<br/>   GROUP BY ft.name, t.name, fa.version<br/>   ORDER BY patients_created DESC;"]
    end